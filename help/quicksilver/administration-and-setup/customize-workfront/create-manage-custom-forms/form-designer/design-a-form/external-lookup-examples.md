---
title: カスタムフォームの「外部ルックアップ」フィールドの例
user-type: administrator
product-area: system-administration
navigation-topic: create-and-manage-custom-forms
description: カスタムフォームの「外部ルックアップ」フィールドは、外部 API を呼び出し、ドロップダウンフィールドのオプションとして値を返します。この記事では、「外部ルックアップ」フィールドを使用して Workfront またはパブリック API の同じインスタンスを呼び出す例を示します。
author: Lisa
feature: System Setup and Administration, Custom Forms
role: Admin
exl-id: 13880fcb-8523-45d2-9ac6-38453e8e2391
source-git-commit: 94957250387012738f2ef4c80864d51bdc2d792f
workflow-type: tm+mt
source-wordcount: '1046'
ht-degree: 90%

---

# カスタムフォームの「外部ルックアップ」フィールドの例

カスタムフォームの「外部ルックアップ」フィールドは、外部 API を呼び出し、ドロップダウンフィールドのオプションとして値を返します。カスタムフォームが添付されているオブジェクトを使用するユーザーは、ドロップダウンからこれらのオプションを 1 つ以上選択できます。

この記事では、「外部ルックアップ」フィールドを使用して Workfront またはパブリック API の同じインスタンスを呼び出す例を示します。また、外部ルックアップを使用して、Jira、Salesforce または ServiceNow などの外部システムと通信することもできます。

カスタムフォームに「外部ルックアップ」フィールドを追加する方法と、外部ルックアップコンポーネントの追加定義について詳しくは、[フォームデザイナーを使用したフォームのデザイン](/help/quicksilver/administration-and-setup/customize-workfront/create-manage-custom-forms/form-designer/design-a-form/design-a-form.md)を参照してください。

## Workfront の同じインスタンスに対して「外部ルックアップ」フィールドを設定

外部ルックアップを使用して、Workfront インスタンスからカスタムフォームにデータを取り込むことができます。

### 外部検索でのネイティブのWorkfront フィールド値の使用

この例では、Workfront API を呼び出して、既存の「ステータスクエリ」フィールドから「外部ルックアップ」フィールドにデータを取り込む方法を示します。

1. カスタムフォームを開きます。
1. 画面の左側で、「**外部ルックアップ**」を見つけて、キャンバス上のセクションにドラッグします。
1. フィールドの&#x200B;**ラベル**&#x200B;と&#x200B;**名前**&#x200B;を入力します。
1. フィールドの&#x200B;**形式**&#x200B;を選択します。
1. API の URL 呼び出しを「**ベース API の URL**」フィールドに入力します。

   * $$HOST を追加すると、同じインスタンスを参照できます。
   * $$QUERY を追加すると、別のフィールドのクエリに基づいて結果をフィルタリングできます。

   **例**
   `$$HOST/attask/api/v15.0/project/search?status={DE:StatusQuery}&$$QUERY`

1. このルックアップフィールドが API で参照しているフィールドの&#x200B;**依存関係**&#x200B;を確認します。

   「依存関係」フィールドには、オブジェクトの詳細ページに存在する任意のカスタムフィールドまたはネイティブフィールドを使用できます。

   この例では、`{DE:StatusQuery}` が StatusQuery カスタムフィールドの値に置き換えられます。

1. 「**HTTP メソッド**」を選択します。

   これは、ほとんどの場合、**Get** になります。

1. **JSON パス**&#x200B;を入力して、API 呼び出しの結果を取得します。

   **例**
   `$.data[*].name`

   >[!NOTE]
   >
   >同じ Workfront インスタンスに対して呼び出しを行う場合は、**ヘッダー**&#x200B;の情報は必要ありません。

1. 「**適用**」をクリックします。

   ![カスタムフォームでの Workfront に対する API 呼び出しの設定](assets/external-lookup-to-workfront.png)

   カスタムフォームが Workfront オブジェクト（この例ではプロジェクト）に追加されると、次のようになります。

   ![「外部ルックアップ」フィールドを含むカスタムフォーム](assets/external-lookup-project-status-example1.png)

   ![ステータスに基づく「外部ルックアップ」オプション](assets/external-lookup-project-status-example2.png)

### 外部参照でのカスタムフィールド値の使用

この例では、Workfront API を呼び出し、カスタムフィールドから外部参照フィールドにデータを取り込む方法を示しています。 例えば、カスタムフィールドは「Custom Colors」と呼ばれます。

1. カスタムフォームを開きます。
1. 画面の左側で、「**外部ルックアップ**」を見つけて、キャンバス上のセクションにドラッグします。
1. フィールドの&#x200B;**ラベル**&#x200B;と&#x200B;**名前**&#x200B;を入力します。
1. フィールドの&#x200B;**形式**&#x200B;を選択します。
1. API の URL 呼び出しを「**ベース API の URL**」フィールドに入力します。

   **例**
   `$$HOST/attask/api/v18.0/PORT/search?ID={portfolioID}&fields=parameterValues`

1. このルックアップフィールドが API で参照しているフィールドの&#x200B;**依存関係**&#x200B;を確認します。

   「依存関係」フィールドには、オブジェクトの詳細ページに存在する任意のカスタムフィールドまたはネイティブフィールドを使用できます。

1. 「**HTTP メソッド**」を選択します。

   これは、ほとんどの場合、**Get** になります。

1. **JSON パス**&#x200B;を入力して、API 呼び出しの結果を取得します。

   **例**
   `$.data[*].parameterValues.["DE:Combo Colors"]`

   * 「parameterValues」は、操作しているオブジェクトのWorkfront内のカスタムフィールドを指します。
   * 例えば、「DE:Combo Colors」は、取得する値を含む特定のカスタムフィールドです。

   >[!NOTE]
   >
   >同じ Workfront インスタンスに対して呼び出しを行う場合は、**ヘッダー**&#x200B;の情報は必要ありません。

1. 「**適用**」をクリックします。

   カスタムフォームがWorkfront オブジェクトに追加されると、「コンボカラー」フィールドのすべての値が外部検索フィールドドロップダウンに表示されます。

## パブリック API 用の「外部ルックアップ」フィールドの設定

外部ルックアップを使用して、外部のパブリック API を呼び出し、データを取得できます。

この例では、ドロップダウンオプションにすべての国名をハードコーディングする必要がないように、国の API（<https://api.first.org/data/v1/countries> など）を呼び出す方法を示します。

1. カスタムフォームを開きます。
1. 画面の左側で、「**外部ルックアップ**」を見つけて、キャンバス上のセクションにドラッグします。
1. フィールドの&#x200B;**ラベル**&#x200B;と&#x200B;**名前**&#x200B;を入力します。
1. フィールドの&#x200B;**形式**&#x200B;を選択します。
1. API の URL 呼び出しを「**ベース API の URL**」フィールドに入力します。

   * $$QUERY を追加すると、エンドユーザーに対するクエリフィルタリングを実装できます。

   **例**
すべての国を一覧表示します。<https://api.first.org/data/v1/countries>

   ユーザーがドロップダウンフィールド内の任意の国を検索できるようにします。<https://api.first.org/data/v1/countries?q=$$QUERY>

   ユーザーが地域内の国を検索できるようにします。<https://api.first.org/data/v1/countries?region={DE:Region}&q=$$QUERY>

   * 使用可能なは、Workfront の別のカスタムフィールドで定義されます。
   * ユーザーがフォーム上で地域を選択すると、「外部ルックアップ」フィールドにはその地域の国のみが表示されます（国が属する地域は API で定義されています）。また、ユーザーは、選択した地域の国を検索することもできます。

1. このルックアップフィールドが API で参照しているフィールドの&#x200B;**依存関係**&#x200B;を確認します。

   「依存関係」フィールドには、オブジェクトの詳細ページに存在する任意のカスタムフィールドまたはネイティブフィールドを使用できます。

   この例では、`{DE:Region}` は、地域カスタムフィールドの値に置き換えられます。

1. 「**HTTP メソッド**」を選択します。

   これは、ほとんどの場合、**Get** になります。

1. **JSON パス**&#x200B;を入力して、API 呼び出しから結果を取得します。

   このオプションを使用すると、API URL から返された JSON からデータを抽出できます。これは、JSON 内のどの値がドロップダウンオプションに表示されるかを選択する手段の役割を果たします。

   **例**
   `$.data[*].country`

1. （オプション）「**ヘッダーを追加**」をクリックし、API での認証に必要なキーと値のペアを入力するか貼り付けます。

   >[!NOTE]
   >
   >「ヘッダー」フィールドは、資格情報を保存する安全な場所ではないので、入力して保存する内容には注意する必要があります。

1. （オプション）ユーザーがドロップダウンで複数の値を選択できるようにするには、「**複数選択ドロップダウン**」を選択します。

1. 「**適用**」をクリックします。

   ![カスタムフォームでのパブリック API への API 呼び出しの設定](assets/external-lookup-to-api-for-countries.png)

   カスタムフォームが Workfront オブジェクト（この例ではプロジェクト）に追加されると、次のようになります。

   ![「外部ルックアップ」フィールドを含むカスタムフォーム](assets/external-lookup-countries-example1.png)

   ![地域に基づく国の「外部ルックアップ」オプション](assets/external-lookup-countries-example2.png)
