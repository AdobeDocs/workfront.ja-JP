---
title: レガシーフォームビルダーを使用した計算データのカスタムフォームへの追加
user-type: administrator
product-area: system-administration
navigation-topic: create-and-manage-custom-forms
description: カスタムフォームでは、計算を生成する計算カスタムフィールドを作成できます。これを行うには、データ式と既存のフィールドの名前を使用するステートメントを作成します。このステートメントには、カスタムフィールド、計算カスタムデータフィールド、組み込み Workfront フィールドを使用できます。このステートメントは、入力したデータを計算し、新しい計算カスタムフィールドに結果を表示します。
author: Lisa
feature: System Setup and Administration, Custom Forms
role: Admin
exl-id: 9174c4ef-3beb-4d47-9c5c-363f52105a2c
source-git-commit: 02b025f228b6e2abc58dbc30f88c055c7850b803
workflow-type: tm+mt
source-wordcount: '2895'
ht-degree: 96%

---

# レガシーフォームビルダーを使用した計算データのカスタムフォームへの追加

<!--Audited: 01/2024-->

{{form-designer-default}}

カスタムフォームでは、カスタムフォームがオブジェクトに添付される際に、既存のデータを使用して新しいデータを生成する計算済みカスタムフィールドを追加できます。

これを行うには、データ式と既存のフィールドの名前を使用するステートメントを作成します。このステートメントには、カスタムフィールド、計算カスタムデータフィールド、組み込み Adobe Workfront フィールドを使用できます。

このステートメントは、入力したデータを計算し、新しい計算カスタムフィールドに結果を表示します。

計算済みカスタムフィールドには、次の値を含めることができます。

* 単一の組み込みフィールドへのシンプルな参照。

  >[!INFO]
  >
  > **例：**&#x200B;プロジェクトとタスクによって生成された収益を計算するには、組み込みフィールド「実収益」を含む計算カスタムフィールドを作成できます。誰かがカスタムフォームをプロジェクトまたはタスクに添付すると、プロジェクトまたはタスクの収益がフィールドに表示されます。

* 1 つ以上のフィールドを参照する式。カスタムフィールド、その他の計算カスタムフィールド、組み込みフィールドなどです。

  >[!INFO]
  >
  >**例：**&#x200B;プロジェクトやタスクによって生成される利益を計算するには、収益からコストを差し引く数式を含む「利益」という計算済みカスタムフィールドを作成できます。
  >
  >これを行うには、組み込みの Workfront フィールド、「実際のコスト」と「実収益」）で数式 SUB（減算）を使用できます。
  >
  >以下の手順で、この例の実行方法を確認できます。

組織のカスタムフォームの作成と、それらに関連付けることができるフィールドのタイプについて詳しくは、[カスタムフォームの作成または編集](../../../administration-and-setup/customize-workfront/create-manage-custom-forms/create-or-edit-a-custom-form.md)を参照してください。

## アクセス要件

+++ 展開すると、この記事の機能のアクセス要件が表示されます。

この記事の手順を実行するには、以下を保有している必要があります。

<table style="table-layout:auto"> 
 <col> 
 <col> 
 <tbody> 
  <tr data-mc-conditions=""> 
   <td role="rowheader"> <p>Adobe Workfront プラン</p> </td> 
   <td>任意</td> 
  </tr> 
  <tr> 
   <td role="rowheader">Adobe Workfront プラン*</td> 
   <td><p>現在：プラン</p>
   または
   <p>新規：標準</p>
   </td> 
  </tr> 
  <tr> 
   <td role="rowheader"><p>アクセスレベル設定</p></td> 
   <td> <p>カスタムフォームへの管理アクセス権</p> </p> </td> 
  </tr>  
 </tbody> 
</table>

*ご利用のプラン、ライセンスタイプまたはアクセスレベル設定を確認するには、Workfront 管理者にお問い合わせください。アクセス要件については、[Workfront ドキュメントのアクセス要件](/help/quicksilver/administration-and-setup/add-users/access-levels-and-object-permissions/access-level-requirements-in-documentation.md)を参照してください。

+++


## カスタムフォームに計算フィールドを追加 {#add-a-calculated-field-to-a-custom-form}

組み込みの Workfront フィールドと、計算カスタムフィールドの式で作成済みのカスタムフィールドの両方を使用できます。

>[!IMPORTANT]
>
>計算カスタムフィールドを作成する前に、計算に必要なデータが Workfront に存在することを確認するために、含める既存のフィールドを特定します。

1. [カスタムフォームの作成または編集](../../../administration-and-setup/customize-workfront/create-manage-custom-forms/create-or-edit-a-custom-form.md)の説明に従って、カスタムフォームの作成または編集を開始します。

1. 「**フィールドを追加**」タブで、「**計算済み**」クリックします。

   右側の表示エリアで、フィールドに入力値 12345 が表示されます。これは、カスタムフォームの作成中または編集中に、そのフィールドが計算カスタムフィールドであることを示す単なるインジケーターです。フォームがオブジェクトに添付され、ユーザーがフォームに入力すると、フィールドには 12345 の値ではなく計算結果が表示されます。

1. 計算フィールドには次の情報を指定します。

   <table style="table-layout:auto"> 
    <col> 
    </col> 
    <col> 
    </col> 
    <tbody> 
     <tr> 
      <td role="rowheader">ラベル</td> 
      <td>フィールドのラベルを入力します。これは、ユーザーがカスタムフォームを使用する際に表示される情報です。フィールドの<b>名前</b>は、自動的に入力され、ラベルと一致し、Workfront によってレポートで参照されます。必須フィールドです。</td> 
     </tr>

   <tr> 
   <td role="rowheader">名前</td> 
   <td>デフォルトでは、フィールドの名前はラベルと同じです。ただし、フィールドの名前を変更して、フィールドのラベルとは異なる名前にすることができます。フィールドの<b>名前</b>は、Workfront によってレポートで参照されます。必須フィールドです。</td> 
   </tr>

   <tr> 
     <td role="rowheader" id="instructions">手順</td> 
      <td> <p>テキストを追加して、フィールドおよびその中の数式に関する追加情報を入力できます。</p>
      <p>また、カスタムフィールドの計算に使用する数式をここに貼り付けることもできます。この場合、まずカスタムフィールドの計算を更新し、次に「計算」フィールドから最終式をコピーして、「手順」フィールドに貼り付けることをお勧めします。 </p>


   これは、次の方法で役立ちます。
   <ul> 
      <li> <p>数式の内容と仕組みを確認するために使用します。これは、複数のフォームでこの計算カスタムフィールドを使用する予定がある場合に特に便利です。</p> </li> 
       <li> <p>フィールドにポインタを合わせると、ツールチップとして表示されます。ツールヒントに表示したいテキストをここに追加できます。</p> </li> 
       </ul>
       <p>ユーザーが混乱する可能性があるため、ツールチップに数式が表示されないようにしたい場合は、「手順」フィールドに追加しないでください。代わりに、「手順に数式を表示する」設定を使用して、数式の表示と非表示を切り替えます。詳しくは、この記事の<a href="#build-the-calculation-for-your-calculated-custom-field">計算済みカスタムフィールドの計算を作成</a>を参照してください。</p>

   <p>新しいフォームで既存の計算カスタムフィールドを使用する方法について詳しくは、<a href="../../../administration-and-setup/customize-workfront/create-manage-custom-forms/use-existing-calc-field-new-custom-form.md#using-an-existing-calculated-custom-field-on-a-new-form" class="MCXref xref">カスタムフォームでの既存の計算カスタムフィールドの再利用</a>を参照してください。</p>

   </td> 
     </tr> 
     <tr> 
      <td role="rowheader">形式</td> 
      <td> <p>フィールドの結果を保存および表示する形式です。</p> <p>フィールドを数学計算で使用する場合は、常に<strong>数字</strong>または<strong>通貨</strong>形式を使用してください。「数値」または「通貨」を選択すると、0 から始まる数値が自動的に切り捨てられます。</p> 
      <p><b>重要</b>： <p>形式を選択する前に、新しいフィールドに適した形式を検討してください。カスタムフォームを保存した後は、形式フィールドを編集できません。また、誤った形式を選択すると、今後の計算や集計値がレポートやリストのグループ化に影響を受ける可能性があります。</p>
      <p><strong>メモ：</strong> 通貨形式の計算フィールドには引用符を含めないでください。例えば、"800.00" ではなく、800.00 を使用してください。引用符を使用すると、通貨タイプの言語形式の微妙な違いにより、予期しない結果が生じる可能性があります。</p></td> 
     </tr> 
    </tbody> 
   </table>

1. 引き続き、カスタムフィールドの情報を更新します。詳しくは、この記事の[計算カスタムフィールドの計算を作成](#build-the-calculation-for-your-calculated-custom-field)の節を参照してください。

## 計算カスタムフィールドの計算を作成 {#build-the-calculation-for-your-calculated-custom-field}

1. 計算カスタムフィールドの作成を開始します。詳しくは、この記事の[カスタムフォームに計算フィールドを追加](#add-a-calculated-field-to-a-custom-form)の節を参照してください。

1. **最大化**&#x200B;をクリックして&#x200B;**計算エディター**&#x200B;を開き、計算を作成します。

   >[!INFO]
   >
   >**例：**&#x200B;この記事の冒頭の例を使用すると、プロジェクトとタスクのカスタムフォームに「利益」という名前の計算カスタムフィールドを作成できます。このフィールドには、実収益と実際のコストの差を表示する計算を含めることができます。
   >
   >`SUB({actualRevenue},{actualCost})`
   >
   >この例では、`SUB` 式であり、参照されるフィールドが `actualRevenue` と `actualCost` です。

   計算は、通常、式で始まり、カスタムフォームがオブジェクトに添付される際に参照するフィールドを含む括弧が続きます。使用可能な式について詳しくは、[計算データ式の概要](../../../reports-and-dashboards/reports/calc-cstm-data-reports/calculated-data-expressions.md)を参照してください。

   それぞれのフィールドを中括弧で囲む必要があります。詳しくは、この記事のセクション[計算カスタムフィールドに必要な構文](#syntax-required-in-calculated-custom-fields)を参照してください。フィールドの名前を入力し始めると、候補が表示されるので、選択して計算に挿入できます。

   >[!NOTE]
   >
   >   計算では、次のタイプのフィールドを参照できません。
   >   
   >   * 書式付きテキストフィールド
   >   * 説明テキスト
   >   
   >   カスタムフィールドのタイプについて詳しくは、[カスタムフォームにカスタムフィールドを追加](../../../administration-and-setup/customize-workfront/create-manage-custom-forms/add-a-custom-field-to-a-custom-form.md)を参照してください。

1. 「計算エディター」ボックスの大きなテキストボックスをクリックし、「検索」または「展開」をクリックして、そのテキストボックスの右にある「**式**&#x200B;と&#x200B;**フィールド**」セクションのオプションをクリックします。これにより、計算に追加されます。

   また、大きいテキストボックスに式やフィールドを入力し、表示されたときに選択することもできます。各項目には、フィールドには「F」、式には「E」が表示されます。

   開き丸括弧を入力すると、閉じ丸括弧が自動的に追加されます。

   >[!TIP]
   >
   >次のいずれかの操作を実行して、計算に関するヘルプを確認することができます。
   > 
   >* 計算の式にカーソルを合わせると、説明、その式の使用方法を示す例、および記事[計算データ式の概要](../../../reports-and-dashboards/reports/calc-cstm-data-reports/calculated-data-expressions.md)の詳細情報への「詳細情報」リンクが表示されます。
   >  ![](assets/hover-expression-help-text.jpg)
   >* 追加したコンポーネントを識別するには、色分けを使用します。式は青色で表示され、フィールドは緑色で表示されます。
   >  ![](assets/colors-fields-expressions.jpg)
   >* 計算エラーを見つけます。計算エラーはピンク色で強調表示されます。強調表示されたエラーの上にポインタを合わせると、その原因に関する簡単な説明が表示されます。
   >  ![](assets/error-help.png)
   >* 計算の下の&#x200B;**既存のオブジェクトのプレビュー**エリアで、Workfront オブジェクトの名前を入力し、リストに表示されたら選択します。これにより、フォームがオブジェクトに添付されたときに、フィールドがどのように表示されるかをプレビューできます。
   ><!--or by providing test values (NOT READY YET; CHANGE THIS SCREENSHOT WHEN IT IS)-->
   >  ![](assets/preview-calc.jpg)
   >* 左側に表示される行番号を使用して、長い計算で式を参照します。

1. 計算カスタムフィールドの計算を完了したら、「**最小化**」をクリックします。

   >[!NOTE]
   >
   >右側の表示エリアで、フィールドに入力値 12345 が表示されます。これは、カスタムフォームの作成中または編集中に、そのフィールドが計算カスタムフィールドであることを示す単なるインジケーターです。フォームがオブジェクトに添付され、ユーザーがフォームに入力すると、フィールドには 12345 の値ではなく計算結果が表示されます。

1. （オプション）次のいずれかのオプションを使用して、計算カスタムフィールドをさらに設定します。

   <table style="table-layout:auto"> 
    <col> 
    <col> 
    <tbody> 
     <tr> 
      <td role="rowheader">ロジックを追加</td> 
      <td>ユーザーがフォームの入力時に、直前の複数選択肢フィールド（ドロップダウン、チェックボックス、ラジオボタン）で 1 つ以上選択した場合に、表示ロジックを追加して、計算フィールドを表示するかどうかを決定できます。詳しくは、<a href="../../../administration-and-setup/customize-workfront/create-manage-custom-forms/display-or-skip-logic-custom-form.md" class="MCXref xref">表示ロジックの追加とカスタムフォームへのロジックのスキップ</a>を参照してください。 <p>これは、フォーム上の計算カスタムフィールドの前に、1 つ以上のチェックボックス、ラジオボタン、ドロップダウンフィールドがある場合にのみ使用できます。 </p> <p>計算カスタムフィールドにはスキップロジックを使用できません。</p> </td> 
     </tr> 
     <tr> 
      <td role="rowheader">以前の計算を更新</td> 
      <td>既存の計算カスタムフィールドの編集時にこのオプションを選択して、カスタムフォームを保存するときに計算の更新をトリガーできます。これは、カスタムフォームを保存するときに 1 回だけ発生します。その後、このオプションは無効状態に戻ります。</td> 
     </tr> 
     <tr> 
      <td role="rowheader">手順に式を表示する</td> 
      <td>カスタムフォームに入力するユーザーがフィールドにポインタを合わせたときに、そのフィールドの数式を表示する場合は、このオプションを有効のままにします。詳しくは、この表の前半にある<a href="#instructions" class="MCXref xref">説明</a>を参照してください。</td> 
     </tr> 
    </tbody> 
   </table>

1. 計算カスタムフィールドの変更がすべて完了したら、「**完了**」をクリックします。

   カスタムフィールドのフォームへの追加を続行する場合は、「**適用**」をクリックして、これまでの変更をフォームに適用します。

   または、カスタムフォームですべての変更が完了したら、「**保存して閉じる**」をクリックします。
1. 計算カスタムフィールドが正しく機能することを確かめるには、カスタムフォームをオブジェクトに添付し、計算カスタムフィールドの結果を確認します。

   カスタムフォームを添付する手順については、[オブジェクトへのカスタムフォームの追加](../../../workfront-basics/work-with-custom-forms/add-a-custom-form-to-an-object.md)を参照してください。

   他の方法でカスタムフォームの作成を続ける場合は、次のいずれかの記事に進んでください。

   * [カスタムフォームへのカスタムフィールドの追加](../../../administration-and-setup/customize-workfront/create-manage-custom-forms/add-a-custom-field-to-a-custom-form.md)
   * [カスタムフォームでのカスタムフィールドおよびウィジェットの配置](../../../administration-and-setup/customize-workfront/create-manage-custom-forms/position-fields-in-a-custom-form.md)
   * [カスタムフォームでのアセットウィジェットを追加または編集](../../../administration-and-setup/customize-workfront/create-manage-custom-forms/add-widget-or-edit-its-properties-in-a-custom-form.md)
   * [カスタムフォームでの既存の計算カスタムフィールドの再利用](../../../administration-and-setup/customize-workfront/create-manage-custom-forms/use-existing-calc-field-new-custom-form.md)
   * [表示ロジックの追加とカスタムフォームへのロジックのスキップ](../../../administration-and-setup/customize-workfront/create-manage-custom-forms/display-or-skip-logic-custom-form.md)
   * [カスタムフォームのプレビューと完了](../../../administration-and-setup/customize-workfront/create-manage-custom-forms/preview-and-complete-a-custom-form.md)

## 計算カスタムフィールドで必要な構文

カスタム計算フィールドで使用される各フィールドは、以下に説明する構文を使用する必要があります。各フィールド名を中括弧で囲みます。フィールドの名前を入力し始めると、候補が表示されるので、選択して計算に挿入できます。計算に誤ったデータを入力すると、警告メッセージが表示されます。有効なフィールドと有効な計算式を含むように計算式を編集しない限り、フォームを保存できません。

>[!NOTE]
>
>現在は、カスタムフォームの添付先となるオブジェクトで参照するフィールドの名前を入力し始めたときにのみ候補が表示されます。オブジェクトの親では表示されません。

### フィールド名を中括弧で囲む

* 計算で組み込みフィールドを参照する場合は、フィールド名を中括弧で囲み、Workfront データベースに表示される形式にする必要があります。Workfront インターフェイスに表示されるフィールドの名前は使用できません。

例：`{actualRevenue}`

フィールド名では大文字と小文字が区別され、Workfront システムでの表示と同じように、キャメルケース形式で表示する必要があります。

* 計算でカスタムフィールドを参照する場合は、フィールド名の前に `DE:` を付けて、全体を中括弧で囲みます。カスタムフィールドでは大文字と小文字が区別され、Workfront インターフェイスで表示される形式にする必要があります。

例：`{DE:Profit}`

`DE:` を入力すると、選択できるすべてのカスタムフィールドが一覧表示されます。

* カスタムフォームがオブジェクトに接続されているときに親オブジェクトからデータを取得するフィールドを計算で参照する場合は、フィールド名の前および中括弧内に親オブジェクトのオブジェクトタイプを付ける必要があります。

  例えば、タスクを使用するようにカスタムフォームを設定し、フォームがタスクに添付されたときにフィールドで親オブジェクトの実収益を計算する場合は、次のように`project` をフィールドのオブジェクトタイプとして指定する必要があります。

  `{project}.{actualRevenue}`

  また、カスタムフィールドの場合は、次のようになります。

  `{project}.{DE:profit}`

  カスタムフォームが複数のオブジェクトタイプに対して設定されているので親オブジェクトのオブジェクトタイプが不明な場合は、ワイルドカードフィルター変数 `$$OBJCODE` を使用して、可能性のあるタイプごとに計算が正常に行われるようにすることができます。詳しくは、この記事の[複数オブジェクトのカスタムフォームの計算カスタムフィールド](#calculated-custom-fields-in-multi-object-custom-forms)を参照してください。

### 項目をピリオドで区切る

計算カスタムフィールドで関連オブジェクトを参照する場合は、オブジェクト名と属性をピリオドで区切る必要があります。

例えば、タスクタイプのカスタムフォームで、計算カスタムフィールドにポートフォリオ所有者の名前を表示するには、次のように入力します。

`{project}.{porfolio}.{owner}`

このシステムでは、次の手順（この順序）で情報を取得します。

1. カスタムフォームのオブジェクト（タスク）から、
1. タスクの親または別の関連オブジェクト（プロジェクト）にアクセスし、
1. 親またはプロジェクトの別の関連オブジェクト（ポートフォリオ）にアクセスし、
1. ポートフォリオに関連する次のオブジェクト（ポートフォリオの所有者）にアクセスします。

### カスタムフィールドを参照するための名前構文

計算カスタムフィールドで別のカスタムフィールドを参照する場合は、Workfront インターフェイスに表示されるフィールドの名前を入力する必要があります。

例えば、「エグゼクティブスポンサー」というラベルの付いたカスタムフィールドで選択したオプションを参照するには、次のように入力します。

`{DE:Executive sponsor}`

>[!NOTE]
>
>先行入力フィールドの構文では最後に `:name` を追加する必要があるため、他のタイプのフィールドの構文とは異なります。
>
>例えば、「エグゼクティブスポンサー」というラベルの付いたカスタム先行入力フィールドで選択したオプションを参照するには、次のように入力します。
>
>`{DE:Executive sponsor:name}`

## 複数オブジェクトのカスタムフォームの計算カスタムフィールド {#calculated-custom-fields-in-multi-object-custom-forms}

複数オブジェクトのカスタムフォームでは、選択したオブジェクトタイプが、フォームの計算カスタムフィールドで参照されるすべてのフィールドと互換性がある必要があります。

>[!INFO]
>
>**例：**
>
>タスクオブジェクトタイプと連携するように設定されたカスタムフォームで、In Charge という名前の計算カスタムフィールドを作成します。組み込みフィールドを参照するようにこのフィールドを設定して、フォームがタスクに添付されるたびに、主な担当者の名前を表示できるようにします。
>
>`{assignedTo}.{name}`
>
>その後、カスタムフォームに Project オブジェクトタイプを追加しますが、Project オブジェクトタイプは計算されたカスタムフィールドと互換性がありません。

この場合、以下のいずれかを行えます。

* カスタムフォームから、互換性のない 2 つの項目（オブジェクトタイプまたは参照されている計算カスタムフィールド）のいずれかを削除します。
* 両方の項目を保持し、ワイルドカードフィルター変数 `$$OBJCODE` を IF 式の条件として使用して、「担当」フィールドの 2 つの異なるバージョンを作成します。これにより、フォームが添付されているオブジェクトのタイプに関係なく、フィールドが正常に機能します。

>[!INFO]
>
>**例：**&#x200B;プロジェクトには、割り当て先：名前フィールドはありませんが、組み込みの所有者フィールドがあります（手動で変更しない限り、プロジェクトの作成者の名前が自動的に入力されます）。
>
>したがって、カスタムの「担当」フィールドで、以下に示すように `$$OBJCODE` を使用して、カスタムフォームがプロジェクトに添付されている場合は「所有者」フィールドを参照でき、フォームがタスクに添付されている場合は「割り当て先：名前」フィールドを参照できます。
>
>`IF($$OBJCODE="PROJ",{owner}.{name},{assignedTo}.{name})`

`$$OBJCODE,` のような変数について詳しくは、[ワイルドカードフィルター変数の概要](/help/quicksilver/reports-and-dashboards/reports/reporting-elements/understand-wildcard-filter-variables.md)を参照してください。

## 計算カスタムフィールドの自動更新

オブジェクトの計算カスタムフィールドは、次の場合に自動的に再計算します。

* 日次のタイムライン計算など、オブジェクト上で変更があったとき。
* オブジェクト上の計算カスタムフィールドで参照されている別のフィールドを、他のユーザーが編集したとき。
* 計算式が空で、フィールドに値が含まれているとき（値が NULL に設定されます）。

  >[!NOTE]
  >
  >オブジェクトに添付されたカスタムフォームでは、計算カスタムフィールドの日付および時刻のステートメントは、組織のインスタンスとユーザープロファイルに設定されたタイムゾーン設定ではなく、協定世界時（UTC）に従って計算および保存されます。ただし、カスタムフォームの計算は、各ユーザーの個々のタイムゾーンに基づいて表示されます。
