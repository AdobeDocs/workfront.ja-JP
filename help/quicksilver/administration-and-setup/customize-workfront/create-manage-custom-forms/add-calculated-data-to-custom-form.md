---
title: レガシーフォームビルダーを使用した計算データのカスタムフォームへの追加
user-type: administrator
product-area: system-administration
navigation-topic: create-and-manage-custom-forms
description: カスタムフォームでは、計算を生成する計算カスタムフィールドを作成できます。これを行うには、データ式と既存のフィールドの名前を使用するステートメントを作成します。このステートメントには、カスタムフィールド、計算カスタムデータフィールド、組み込み Workfront フィールドを使用できます。このステートメントは、入力したデータを計算し、新しい計算カスタムフィールドに結果を表示します。
author: Lisa
feature: System Setup and Administration, Custom Forms
role: Admin
exl-id: 9174c4ef-3beb-4d47-9c5c-363f52105a2c
source-git-commit: dda00a43c5122a233ce2849d828d2e5e4555d2d9
workflow-type: tm+mt
source-wordcount: '2863'
ht-degree: 59%

---

# レガシーフォームビルダーを使用した計算データのカスタムフォームへの追加

<!--Audited: 01/2024-->

カスタムフォームでは、カスタムフォームがオブジェクトに添付される際に、既存のデータを使用して新しいデータを生成する計算済みカスタムフィールドを追加できます。

これをおこなうには、データ式と既存のフィールドの名前を使用するステートメントを作成します。このステートメントには、カスタムフィールド、計算カスタムデータフィールド、組み込みAdobe Workfrontフィールドを使用できます。

このステートメントは、入力したデータを計算し、新しい計算カスタムフィールドに結果を表示します。

計算済みカスタムフィールドには、次の値を含めることができます。

* 単一の組み込みフィールドへのシンプルな参照。

  >[!INFO]
  >
  > **例：**&#x200B;プロジェクトとタスクによって生成された収益を計算するには、組み込みフィールド「実収益」を含む計算カスタムフィールドを作成できます。誰かがカスタムフォームをプロジェクトまたはタスクに添付すると、プロジェクトまたはタスクの収益がフィールドに表示されます。

* 1 つ以上のフィールドを参照する式。これには、カスタムフィールド、その他の計算済みカスタムフィールド、組み込みフィールドを指定できます。

  >[!INFO]
  >
  >**例：**&#x200B;プロジェクトやタスクによって生成される利益を計算するには、収益からコストを差し引く数式を含む「利益」という計算済みカスタムフィールドを作成できます。
  >
  >これを行うには、組み込みの Workfront フィールド、「実際のコスト」と「実収益」）で数式 SUB（減算）を使用できます。
  >
  >以下の手順で、この例の実行方法を確認できます。

組織のカスタムフォームの作成と、それらに関連付けることができるフィールドのタイプについて詳しくは、[カスタムフォームの作成または編集](../../../administration-and-setup/customize-workfront/create-manage-custom-forms/create-or-edit-a-custom-form.md)を参照してください。

## アクセス要件

この記事の手順を実行するには、以下を保有している必要があります。

<table style="table-layout:auto"> 
 <col> 
 <col> 
 <tbody> 
  <tr data-mc-conditions=""> 
   <td role="rowheader"> <p>Adobe Workfront プラン</p> </td> 
   <td>任意</td> 
  </tr> 
  <tr> 
   <td role="rowheader">Adobe Workfront ライセンス*</td> 
   <td><p>現在：プラン</p>
   または
   <p>新規：標準</p>
   </td> 
  </tr> 
  <tr> 
   <td role="rowheader"><p>アクセスレベルの設定</p></td> 
   <td> <p>カスタムフォームへの管理アクセス権</p> </p> </td> 
  </tr>  
 </tbody> 
</table>

*保有しているプラン、ライセンスの種類、アクセスレベルの設定を確認するには、Workfront管理者にお問い合わせください。 アクセス要件について詳しくは、 [Workfrontドキュメントのアクセス要件](/help/quicksilver/administration-and-setup/add-users/access-levels-and-object-permissions/access-level-requirements-in-documentation.md).


## カスタムフォームに計算フィールドを追加 {#add-a-calculated-field-to-a-custom-form}

組み込みのWorkfrontフィールドと、計算カスタムフィールドの式で作成済みのカスタムフィールドの両方を使用できます。

>[!IMPORTANT]
>
>計算用カスタムフィールドを作成する前に、計算に必要なデータがWorkfrontに確実に存在するように、含める既存のフィールドを指定します。

1. [カスタムフォームの作成または編集](../../../administration-and-setup/customize-workfront/create-manage-custom-forms/create-or-edit-a-custom-form.md)の説明に従って、カスタムフォームの作成または編集を開始します。

1. 「**フィールドを追加**」タブで、「**計算済み**」クリックします。

   右側の表示領域で、フィールドに入力値12345が表示されます。 これは、カスタムフォームの作成中または編集中に、そのフィールドが計算済みのカスタムフィールドであることを示す指標です。 フォームがオブジェクトに添付され、ユーザーがフォームに入力すると、12345値ではなく、フィールドに計算の結果が表示されます。

1. 計算フィールドには次の情報を指定します。

   <table style="table-layout:auto"> 
    <col> 
    </col> 
    <col> 
    </col> 
    <tbody> 
     <tr> 
      <td role="rowheader">ラベル</td> 
      <td>フィールドのラベルを入力します。ユーザーがカスタムフォームを使用すると、このような画面が表示されます。 フィールド <b>名前</b>は自動的に入力され、ラベルに一致します。これは、Workfrontがレポートで参照します。 必須フィールドです。</td> 
     </tr>

   <tr> 
   <td role="rowheader">名前</td> 
   <td>デフォルトでは、フィールドの名前はラベルと同じです。 ただし、フィールドの名前を変更して、フィールドのラベルとは異なる名前にすることができます。 フィールド <b>名前</b> は、レポートでWorkfrontによって参照されます。 必須フィールドです。</td> 
   </tr>

   <tr> 
     <td role="rowheader" id="instructions">手順</td> 
      <td> <p>テキストを追加して、フィールドおよびその中の数式に関する追加情報を提供します。</p>
      <p>また、カスタムフィールドの計算に使用する数式をここに貼り付けることもできます。 この場合、まずカスタムフィールドの計算を更新し、次に「計算」フィールドから最終式をコピーして、「手順」フィールドに貼り付けることをお勧めします。 </p>


   これは、次の方法で役立ちます。
   <ul> 
      <li> <p>数式の内容と仕組みを確認するために使用します。これは、複数のフォームでこの計算カスタムフィールドを使用する予定がある場合に特に便利です。</p> </li> 
       <li> <p>フィールドにポインタを合わせると、ツールチップとして表示されます。ここにテキストを追加し、ツールチップに表示させます。</p> </li> 
       </ul>
       <p>ツールチップに数式が表示されないようにしたい場合は、「説明」フィールドに数式を追加しないでください。 代わりに、「説明の数式を表示する」設定を使用して、数式の表示と非表示を切り替えます（この記事で詳しく説明します）。 <a href="#build-the-calculation-for-your-calculated-custom-field">計算されたカスタムフィールドの計算を作成する</a> 」を参照してください。</p>

   <p>新しいフォームで既存の計算カスタムフィールドを使用する方法について詳しくは、<a href="../../../administration-and-setup/customize-workfront/create-manage-custom-forms/use-existing-calc-field-new-custom-form.md#using-an-existing-calculated-custom-field-on-a-new-form" class="MCXref xref">カスタムフォームでの既存の計算カスタムフィールドの再利用</a>を参照してください。</p>

   </td> 
     </tr> 
     <tr> 
      <td role="rowheader">形式</td> 
      <td> <p>フィールドの結果を保存および表示する形式です。</p> <p>このフィールドを数学計算で使用する場合は、常に <strong>数値</strong> または <strong>通貨</strong> 形式を使用します。 「数値」または「通貨」を選択すると、0 から始まる数値が自動的に切り捨てられます。</p> 
      <p><b>重要</b>： <p>形式を選択する前に、新しいフィールドの正しい形式を考慮してください。 カスタムフォームを保存した後は、形式フィールドを編集できません。また、誤った形式を選択すると、今後の計算や集計値がレポートやリストのグループ化に影響を受ける可能性があります。</p> </td> 
     </tr> 
    </tbody> 
   </table>

1. カスタムフィールドの情報は、引き続き「 」セクションで説明されているように更新します。 [計算されたカスタムフィールドの計算を作成する](#build-the-calculation-for-your-calculated-custom-field) 」を参照してください。

## 計算カスタムフィールドの計算を作成 {#build-the-calculation-for-your-calculated-custom-field}

1. 「 」の節で説明されているように、計算済みカスタムフィールドの作成を開始します。 [カスタムフォームに計算フィールドを追加する](#add-a-calculated-field-to-a-custom-form) 」を参照してください。

1. **最大化**&#x200B;をクリックして&#x200B;**計算エディター**&#x200B;を開き、計算を作成します。

   >[!INFO]
   >
   >**例：**&#x200B;この記事の冒頭の例を使用すると、プロジェクトとタスクのカスタムフォームに「利益」という名前の計算カスタムフィールドを作成できます。このフィールドには、実収益と実際のコストの差を表示する計算を含めることができます。
   >
   >`SUB({actualRevenue},{actualCost})`
   >
   >この例では、`SUB` 式であり、参照されるフィールドが `actualRevenue` と `actualCost` です。

   計算は、通常、式で始まり、カスタムフォームがオブジェクトに添付される際に参照するフィールドを含む括弧が続きます。使用可能な式について詳しくは、 [計算データ式の概要](../../../reports-and-dashboards/reports/calc-cstm-data-reports/calculated-data-expressions.md).

   各フィールドは中括弧で囲む必要があります。詳しくは、 [計算カスタムフィールドに必要な構文](#syntax-required-in-calculated-custom-fields) 」を参照してください。 フィールドの名前を入力し始めると、候補が表示されるので、選択して計算に挿入できます。

   >[!NOTE]
   >
   >   計算では、次のタイプのフィールドを参照できません。 
   >   
   >   * 書式付きテキストフィールド
   >   * 説明テキスト。
   >   
   >   カスタムフィールドのタイプについて詳しくは、 [カスタムフォームにカスタムフィールドを追加する](../../../administration-and-setup/customize-workfront/create-manage-custom-forms/add-a-custom-field-to-a-custom-form.md).

1. [ 計算エディタ ] ボックスの大きなテキストボックスをクリックし、[ 検索 ] または [ 展開 ] をクリックして、 **式** および **フィールド** 」セクションをクリックします。 これにより、計算に追加されます。

   また、大きいテキストボックスに式やフィールドを入力し、表示されたときに選択することもできます。各項目には、フィールドには「F」、式には「E」が表示されます。

   開き丸括弧を入力すると、閉じ丸括弧が自動的に追加されます。

   >[!TIP]
   >
   >次のいずれかの操作を実行して、計算に関するヘルプを確認することができます。
   > 
   >* 計算式の上にマウスポインターを置くと、説明、使用方法を示す例、記事の詳細情報への「詳細」リンクが表示されます [計算データ式の概要](../../../reports-and-dashboards/reports/calc-cstm-data-reports/calculated-data-expressions.md).
   >  ![](assets/hover-expression-help-text.jpg)
   >* 追加したコンポーネントを識別するには、色分けを使用します。式は青色で表示され、フィールドは緑色で表示されます。
   >  ![](assets/colors-fields-expressions.jpg)
   >* 計算エラーを見つけます。計算エラーはピンク色で強調表示されます。強調表示されたエラーの上にポインタを合わせると、その原因に関する簡単な説明が表示されます。
   >  ![](assets/error-help.png)
   >* Adobe Analytics の **既存のオブジェクトのプレビュー** 演算の下の領域で、Workfrontオブジェクトの名前を入力し、リストに表示されたら選択します。 これにより、フォームがオブジェクトに添付されたときに、フィールドがどのように表示されるかをプレビューできます。
   ><!--or by providing test values (NOT READY YET; CHANGE THIS SCREENSHOT WHEN IT IS)-->
   >  ![](assets/preview-calc.jpg)
   >* 左側に表示される行番号を使用して、長い計算で式を参照します。

1. 計算カスタムフィールドの計算を完了したら、「**最小化**」をクリックします。

   >[!NOTE]
   >
   >右側の表示領域で、フィールドに入力値12345が表示されます。 これは、カスタムフォームの作成中または編集中に、そのフィールドが計算済みのカスタムフィールドであることを示す指標です。 フォームがオブジェクトに添付され、ユーザーがフォームに入力すると、12345値ではなく、フィールドに計算の結果が表示されます。

1. （オプション）次のいずれかのオプションを使用して、計算カスタムフィールドをさらに設定します。

   <table style="table-layout:auto"> 
    <col> 
    <col> 
    <tbody> 
     <tr> 
      <td role="rowheader">ロジックを追加</td> 
      <td>ユーザーがフォームの入力時に、直前の複数選択肢フィールド（ドロップダウン、チェックボックス、ラジオボタン）で 1 つ以上選択した場合に、表示ロジックを追加して、計算フィールドを表示するかどうかを決定できます。詳しくは、<a href="../../../administration-and-setup/customize-workfront/create-manage-custom-forms/display-or-skip-logic-custom-form.md" class="MCXref xref">表示ロジックの追加とカスタムフォームへのロジックのスキップ</a>を参照してください。 <p>これは、フォーム上の計算カスタムフィールドの前に、1 つ以上のチェックボックス、ラジオボタン、ドロップダウンフィールドがある場合にのみ使用できます。 </p> <p>計算カスタムフィールドにはスキップロジックを使用できません。</p> </td> 
     </tr> 
     <tr> 
      <td role="rowheader">以前の計算を更新</td> 
      <td>既存の計算カスタムフィールドの編集時にこのオプションを選択して、カスタムフォームを保存するときに計算の更新をトリガーできます。これは、カスタムフォームを保存するときに 1 回だけ発生します。その後、このオプションは無効状態に戻ります。</td> 
     </tr> 
     <tr> 
      <td role="rowheader">手順に式を表示する</td> 
      <td>カスタムフォームに入力するユーザーがフィールドにポインタを合わせたときに、そのフィールドの数式を表示する場合は、このオプションを有効のままにします。詳しくは、この表の前半にある<a href="#instructions" class="MCXref xref">説明</a>を参照してください。</td> 
     </tr> 
    </tbody> 
   </table>

1. 計算カスタムフィールドの変更がすべて完了したら、「**完了**」をクリックします。

   カスタムフィールドのフォームへの追加を続行する場合は、「**適用**」をクリックして、これまでの変更をフォームに適用します。

   または、カスタムフォームですべての変更が完了したら、「**保存して閉じる**」をクリックします。
1. 計算カスタムフィールドが正しく機能することを確かめるには、カスタムフォームをオブジェクトに添付し、計算カスタムフィールドの結果を確認します。

   カスタムフォームを添付する手順については、[オブジェクトへのカスタムフォームの追加](../../../workfront-basics/work-with-custom-forms/add-a-custom-form-to-an-object.md)を参照してください。

   他の方法でカスタムフォームの作成を続ける場合は、次のいずれかの記事に進んでください。

   * [カスタムフォームへのカスタムフィールドの追加](../../../administration-and-setup/customize-workfront/create-manage-custom-forms/add-a-custom-field-to-a-custom-form.md)
   * [カスタムフォームでのカスタムフィールドおよびウィジェットの配置](../../../administration-and-setup/customize-workfront/create-manage-custom-forms/position-fields-in-a-custom-form.md)
   * [カスタムフォームでのアセットウィジェットを追加または編集](../../../administration-and-setup/customize-workfront/create-manage-custom-forms/add-widget-or-edit-its-properties-in-a-custom-form.md)
   * [カスタムフォームでの既存の計算カスタムフィールドの再利用](../../../administration-and-setup/customize-workfront/create-manage-custom-forms/use-existing-calc-field-new-custom-form.md)
   * [表示ロジックの追加とカスタムフォームへのロジックのスキップ](../../../administration-and-setup/customize-workfront/create-manage-custom-forms/display-or-skip-logic-custom-form.md)
   * [カスタムフォームのプレビューと完了](../../../administration-and-setup/customize-workfront/create-manage-custom-forms/preview-and-complete-a-custom-form.md)

## 計算カスタムフィールドで必要な構文

カスタム計算フィールドで使用する各フィールドは、以下に説明する構文を使用する必要があります。各フィールド名は波括弧で囲みます。 フィールドの名前を入力し始めると、候補が表示されるので、選択して計算に挿入できます。計算に誤ったデータを入力すると、警告メッセージが表示されます。有効なフィールドと有効な計算式を含むように計算式を編集しない限り、フォームを保存できません。

>[!NOTE]
>
>現在、カスタムフォームを添付するオブジェクトで参照するフィールドの名前を入力し始めたときにのみ候補が表示されます。オブジェクトの親では表示されません。

### フィールド名を中括弧で囲む

* 計算で組み込みフィールドを参照する場合は、フィールド名を中括弧で囲み、Workfrontデータベースに表示される形式にする必要があります。 Workfrontインターフェイスに表示されるフィールドの名前を使用することはできません。

例：`{actualRevenue}`

フィールド名では大文字と小文字が区別され、Workfrontシステムで表示されるように、キャメルケース形式で表示する必要があります。

* 計算でカスタムフィールドを参照する場合は、フィールド名を中括弧で囲み、先頭に `DE:` を指定します。 カスタムフィールドでは大文字と小文字が区別され、Workfrontインターフェイスで表示される形式にする必要があります。

例：`{DE:Profit}`

`DE:` を入力すると、選択できるすべてのカスタムフィールドが一覧表示されます。

* カスタムフォームがオブジェクトに添付されているときに、親オブジェクトからデータを取り込むフィールドを計算で参照する場合は、フィールド名の前に親オブジェクトのオブジェクトタイプを付け、中括弧で囲む必要があります。

  例えば、タスクを使用するようにカスタムフォームを設定し、フォームがタスクに添付されたときにフィールドで親オブジェクトの実収益を計算する場合は、次のように`project` をフィールドのオブジェクトタイプとして指定する必要があります。

  `{project}.{actualRevenue}`

  また、カスタムフィールドの場合は、次のようになります。

  `{project}.{DE:profit}`

  カスタムフォームが複数のオブジェクトタイプに対して設定されているので、親オブジェクトのオブジェクトタイプが不明な場合は、ワイルドカードフィルター変数を使用できます `$$OBJCODE` を使用すると、使用可能な各タイプに対して計算が機能します。 詳しくは、この記事の[複数オブジェクトのカスタムフォームの計算カスタムフィールド](#calculated-custom-fields-in-multi-object-custom-forms)を参照してください。

### 項目をピリオドで区切る

計算カスタムフィールドで関連オブジェクトを参照する場合は、オブジェクト名と属性をピリオドで区切る必要があります。

例えば、タスクタイプのカスタムフォームで、計算カスタムフィールドにポートフォリオ所有者の名前を表示するには、次のように入力します。

`{project}.{porfolio}.{owner}`

このシステムは、次の手順で情報を取得します（この順序で）。

1. カスタムフォームのオブジェクト（タスク）から、
1. タスクの親または他の関連オブジェクト（プロジェクト）にアクセスし、
1. 親またはプロジェクトの他の関連オブジェクト（ポートフォリオ）にアクセスし、
1. ポートフォリオの次の関連オブジェクト（ポートフォリオの所有者）にアクセスします。

### カスタムフィールドを参照するための名前構文

計算済みカスタムフィールドで別のカスタムフィールドを参照する場合、Workfrontインターフェイスに表示されるフィールドの名前を入力する必要があります。

例えば、「エグゼクティブスポンサー」というラベルの付いたカスタムフィールドで選択したオプションを参照するには、次のように入力します。

`{DE:Executive sponsor}`

>[!NOTE]
>
>Typeahead フィールドの構文は、他のタイプのフィールドの構文とは異なります。これは、を追加する必要があるためです `:name` 最後に
>
>例えば、「エグゼクティブスポンサー」というラベルの付いたカスタム先行入力フィールドで選択したオプションを参照するには、次のように入力します。
>
>`{DE:Executive sponsor:name}`

## 複数オブジェクトのカスタムフォームの計算カスタムフィールド {#calculated-custom-fields-in-multi-object-custom-forms}

複数オブジェクトのカスタムフォームでは、選択したオブジェクトタイプが、フォームの計算カスタムフィールドで参照されているすべてのフィールドと互換性を持っている必要があります。互換性がない場合は、調整を行うように警告するメッセージが表示されます。

>[!INFO]
>
>**例：**
>
>タスクオブジェクトタイプと連携するように設定されたカスタムフォームで、In Charge という名前の計算カスタムフィールドを作成します。組み込みフィールドを参照するようにこのフィールドを設定して、フォームがタスクに添付されるたびに、主な担当者の名前を表示できるようにします。
>
>`{assignedTo}.{name}`
>
>その後で、カスタムフォームにプロジェクトのオブジェクトタイプを追加します。オブジェクトタイプ「プロジェクト」が計算カスタムフィールドと互換性がないことを示す警告メッセージが表示されます。

この場合、以下のいずれかを行えます。

* カスタムフォームから互換性のない 2 つのアイテム（オブジェクトタイプまたは参照先の計算カスタムフィールド）のうち 1 つを削除します。
* 両方のアイテムを保持し、ワイルドカードフィルター変数 `$$OBJCODE` を IF 式の条件として使用して、In Charge フィールドの 2 つの異なるバージョンを作成します。これにより、フォームが添付されているオブジェクトのタイプに関係なく、フィールドが正常に機能します。

>[!INFO]
>
>**例：**&#x200B;プロジェクトには、割り当て先：名前フィールドはありませんが、組み込みの所有者フィールドがあります（手動で変更しない限り、プロジェクトの作成者の名前が自動的に入力されます）。
>
>したがって、カスタムの「担当」フィールドで、以下に示すように `$$OBJCODE` を使用して、カスタムフォームがプロジェクトに添付されている場合は「所有者」フィールドを参照でき、フォームがタスクに添付されている場合は「割り当て先：名前」フィールドを参照できます。
>
>`IF($$OBJCODE="PROJ",{owner}.{name},{assignedTo}.{name})`

次のような変数について詳しくは、 `$$OBJCODE,` 参照 [ワイルドカードフィルター変数の概要](../../../reports-and-dashboards/reports/reporting-elements/understand-wildcard-filter-variables.md).

## 計算カスタムフィールドの自動更新

オブジェクトの計算カスタムフィールドは、次の場合に自動的に再計算します。

* 日次のタイムライン計算など、オブジェクト上で変更があったとき。
* オブジェクト上の計算カスタムフィールドで参照されている別のフィールドを、他のユーザーが編集したとき。
* 計算式が空で、フィールドに値が含まれているとき（値が NULL に設定されます）。

  >[!NOTE]
  >
  ><div>オブジェクトに関連付けられたカスタムフォームでは、計算されたカスタムフィールドの日付と時刻のステートメントは、組織のインスタンスとユーザープロファイルに設定されたタイムゾーン設定に従ってではなく、協定世界時 (UTC) に従って計算され、保存されます。 カスタムフォームの計算は、各ユーザーの個々のタイムゾーンに基づいて生成されます。</div>
